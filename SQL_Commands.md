# คู่มือคำสั่ง SQL ฉบับสรุป

## โครงสร้างหลักของ SQL

SQL แบ่งออกเป็น 3 ส่วนหลัก:
1. **DQL (Data Query Language)** - ใช้สำหรับค้นหาและดึงข้อมูล
2. **DML (Data Manipulation Language)** - ใช้สำหรับจัดการข้อมูลในตาราง
3. **DDL (Data Definition Language)** - ใช้สำหรับจัดการโครงสร้างฐานข้อมูล

## คำสั่งพื้นฐานที่ควรรู้

### 1. SELECT - การดึงข้อมูล
```sql
SELECT column1, column2 FROM table_name;
SELECT * FROM table_name;  -- ดึงทุกคอลัมน์
```

#### การจัดเรียงข้อมูล (ORDER BY)
- `ORDER BY column ASC` - เรียงจากน้อยไปมาก
- `ORDER BY column DESC` - เรียงจากมากไปน้อย

#### การกรองข้อมูล (WHERE)
- เงื่อนไขพื้นฐาน: `=`, `<>`, `<`, `>`, `<=`, `>=`
- `BETWEEN` - ช่วงข้อมูล
- `LIKE` - ค้นหาแบบ pattern
- `IN` - อยู่ในชุดข้อมูล
- `AND`, `OR`, `NOT` - ตัวดำเนินการทางตรรกะ

#### การจัดกลุ่ม (GROUP BY)
```sql
SELECT column, COUNT(*) 
FROM table_name 
GROUP BY column
HAVING count > 1;
```

### 2. DML - การจัดการข้อมูล
- `INSERT` - เพิ่มข้อมูล
- `UPDATE` - แก้ไขข้อมูล
- `DELETE` - ลบข้อมูล

### 3. DDL - การจัดการโครงสร้าง
- `CREATE` - สร้างตาราง/ฐานข้อมูล
- `ALTER` - แก้ไขโครงสร้าง
- `DROP` - ลบตาราง/ฐานข้อมูล

### 4. JOIN - การเชื่อมตาราง
- `INNER JOIN` - เชื่อมเฉพาะข้อมูลที่ตรงกัน
- `LEFT JOIN` - เชื่อมโดยเอาข้อมูลทั้งหมดจากตารางซ้าย
- `RIGHT JOIN` - เชื่อมโดยเอาข้อมูลทั้งหมดจากตารางขวา
- `FULL JOIN` - เชื่อมเอาข้อมูลทั้งหมดจากทั้งสองตาราง

### 5. ฟังก์ชันที่ใช้บ่อย
- Aggregate Functions:
  - `COUNT()` - นับจำนวนแถว
  - `SUM()` - ผลรวม
  - `AVG()` - ค่าเฉลี่ย
  - `MAX()` - ค่าสูงสุด
  - `MIN()` - ค่าต่ำสุด

- Window Functions:
  - `ROW_NUMBER()` - ลำดับแถว
  - `RANK()` - ลำดับแบบมีเลขซ้ำ
  - `DENSE_RANK()` - ลำดับแบบไม่เว้นเลข
  - `LAG()` - ดึงข้อมูลแถวก่อนหน้า
  - `LEAD()` - ดึงข้อมูลแถวถัดไป

## ข้อควรระวัง

1. **การใช้ SELECT * **
   - ควรระบุชื่อคอลัมน์ที่ต้องการแทนการใช้ *
   - ประหยัดทรัพยากรและป้องกันการดึงข้อมูลที่ไม่จำเป็น

2. **การใช้ WHERE**
   - ต้องระวังเงื่อนไขที่อาจทำให้ query ช้า
   - ควรใช้ index ในคอลัมน์ที่ใช้ค้นหาบ่อย

3. **การใช้ JOIN**
   - ระวังการ join ที่อาจทำให้เกิด Cartesian Product
   - ควรระบุเงื่อนไข join ให้ชัดเจน

4. **การใช้ GROUP BY**
   - ต้องระบุทุกคอลัมน์ที่อยู่ใน SELECT (ยกเว้น aggregate functions)
   - ใช้ HAVING สำหรับเงื่อนไขหลัง GROUP BY

5. **การใช้ Transaction**
   - ควรใช้ BEGIN TRANSACTION เมื่อต้องการความแน่นอนในการทำงาน
   - อย่าลืม COMMIT หรือ ROLLBACK

6. **Performance**
   - ใช้ index อย่างเหมาะสม
   - หลีกเลี่ยงการใช้ subquery ที่ซับซ้อนเกินไป
   - ระวังการใช้ temporary table หรือ view ที่อาจทำให้ query ช้า

## แนวทางการเขียน SQL ที่ดี

1. ใช้ชื่อที่สื่อความหมาย
2. จัดรูปแบบโค้ดให้อ่านง่าย
3. เขียน comment อธิบายเมื่อ query ซับซ้อน
4. ทดสอบ query กับข้อมูลตัวอย่างก่อนใช้จริง
5. ตรวจสอบ execution plan เพื่อ optimize performance 